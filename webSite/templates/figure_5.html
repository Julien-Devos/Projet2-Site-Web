{% extends 'base.html' %}

{% block header %}
    <title>{% block title %}Figure 5{% endblock %}</title>
{% endblock %}
{% block content %}
   <body>
        <h1 class="titre" id="figures">Figure 5</h1>
        <div class="box">
            <p class="paragraphe" id="p1">
                Il est courrant dans des fermes commme celle des 3 chênes d'utiliser des doses d’insémination artificielles.
                Comme ces doses ne sont pas donnés, il est important de bien choisir les familles les plus avantageuses pour recevoir ces doses.
                Les familles en plus grand besoin sont celles où le taux de vaches femmelles est trop bas, mais aussi
                avec un taux de jumeaux le plus faible possible (il est moins probable que la gestation aille jusqu’au bout dans des cas de jumeaux)
                et avec un taux de morts prématurés également le plus faible possible.
            </p>
        </div>
        <div class="box">
            <p class="paragraphe" id="p2">
                Le graphique ci-dessous vise à mettre en évidence les différences entre les familles et illustre par son
                graphique les taux de vaches femelles, mort prématurés et de jumeaux pour chauque famille.
                Le graphique contient également une courbe pour le nombre de velages par famille, permettant de voir
                quelle famille avec une plus grande population maintien des taux faibles.
            </p>
        </div>
        <div class="figure" id="fig3.2">
            <canvas id="line-chart" width="100%" height="100%"></canvas>
        </div>
<!--        <canvas id="line-chart" width="1600" height="700"></canvas>-->
        <script>
            var css = getComputedStyle(document.body)
            var fCol = css.getPropertyValue('--fColB')
            var jCol = css.getPropertyValue('--jColB')
            var dCol = css.getPropertyValue('--dColB')
            var vCol = css.getPropertyValue('--vColB')
            var tCol = css.getPropertyValue('--tCol')
            var lCol = css.getPropertyValue('--lCol')
            var xGCol = css.getPropertyValue('--xGCol')
            var xValCol = css.getPropertyValue('--xValCol')
            var yGCol = css.getPropertyValue('--yGCol')
            var yValCol = css.getPropertyValue('--yValCol')

            var nfamilles = {{ data[0] | safe }}
            var taux_fem = {{ data[1] | safe }}
            var taux_jum = {{ data[2] | safe }}
            var dead = {{ data[3] | safe }}
            var n_velages = {{ data[4] | safe }}

            var ctx = document.getElementById('line-chart');
            var stackedLine = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: nfamilles,
                    datasets: [
                        {
                            label: "Taux de femelles",
                            data: taux_fem,
                            borderColor: fCol,
                            fill: false
                        },
                        {
                            label: "Taux de jumeaux",
                            data: taux_jum,
                            borderColor: jCol,
                            fill: false
                        },
                        {
                            label: "Taux de morts prématurés",
                            data: dead,
                            borderColor: dCol,
                            fill: false
                        },
                        {
                            label: "Nombre de velages",
                            data: n_velages,
                            borderColor: vCol,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            stacked: true
                        },
                        xAxes: [{
                          gridLines: {
                              color: xGCol
                            },
                          ticks: {
                              fontColor: xValCol
                          },
                        }],
                      yAxes: [{
                          gridLines: {
                                color: yGCol
                            },
                          ticks: {
                              fontColor: yValCol
                          },
                        }],
                    },
                    layout: {
                      padding: 25
                    },
                    title: {
                        display: true,
                        text: "Graphique des taux de femelles, de jumeaux, de morts prématurés et du nombre de velages par famille",
                        fontColor: tCol
                    },
                    legend: {
                        labels: {
                            fontColor: lCol
                        }
                    },
                    tooltips: {
                        mode: 'label',
                    },
                }
            });
        </script>
   </body>
{% endblock %}
