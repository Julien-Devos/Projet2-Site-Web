{% extends 'base.html' %}

{% block header %}
    <h1>{% block title %}Figure 4{% endblock %}</h1>
{% endblock %}

{% block content %}
    <body>
        <div class="flex-text">
            <h1 class="title" id="figure4">Figure 4</h1>
        </div>
        <div class="flex-text">
            <p class="paragraph">La figure 4.2 décrit, pour chaque famille, le taux de décès prématurés. Ce taux est également comparé au taux de veaux encore vivants aprés un certain laps de temps.
                 Ces taux sont calculés par rapport au nombre total de velages dans chaque famille.</p>
        </div>
        <div>
            <canvas id="bar-chart" width="1600" height="500"></canvas>
        </div>
            <script>
                var css = getComputedStyle(document.body)
                var vCol = css.getPropertyValue('--vColJ')
                var vHovCol = css.getPropertyValue('--vHovColJ')
                var mCol = css.getPropertyValue('--mColJ')
                var mHovCol = css.getPropertyValue('--mHovColJ')
                var dCol = css.getPropertyValue('--dColJ')
                var dHovCol = css.getPropertyValue('--dHovColJ')
                var totCol = css.getPropertyValue('--totColJ')
                var totHovCol = css.getPropertyValue('--totHovColJ')
                var tCol = css.getPropertyValue('--tCol')
                var lCol = css.getPropertyValue('--lCol')
                var xGCol = css.getPropertyValue('--xGCol')
                var xValCol = css.getPropertyValue('--xValCol')
                var yGCol = css.getPropertyValue('--yGCol')
                var yValCol = css.getPropertyValue('--yValCol')


                var familles = {{data[0] | safe}}
                var vivant = {{data[1] | safe}}
                var decede = {{data[2] | safe}}
                var total = {{data[3] | safe}}

                var bar_ctx = document.getElementById('bar-chart');
                var bar_chart = new Chart(bar_ctx, {
                    type: 'bar',
                    data: {
                        labels: familles,
                        datasets: [
                        {
                            label: ' Veaux Vivants',
                            data: vivant,
                            backgroundColor: vCol,
                            hoverBackgroundColor: vHovCol,
                            hoverBorderWidth: 0
                        },
                        {
                            label: 'Décédés prématurément',
                            data: decede,
                            backgroundColor: dCol,
                            hoverBackgroundColor: dHovCol,
                            hoverBorderWidth: 0
                        },
                        {
                            label: 'Nombre total de velages',
                            data: total,
                            backgroundColor: totCol,
                            hoverBackgroundColor: totHovCol,
                            hoverBorderWidth: 0,
                            hidden: true
                        }
                        ]
                    },

                        options: {
                         layout: {
                           padding: 25
                         },
                         title: {
                             display: true,
                             text: "Pourcentage d'animaux décédés prématurément",
                             fontColor: tCol,
                         },
                         legend: {
                             labels: {
                                 fontColor: lCol
                             }
                         },
                         responsive: true,
                         maintainAspectRatio: false,
                         tooltips: {
                             mode: 'label',
                         },
                         scales: {
                          xAxes: [{
                              gridLines: {
                                  color: xGCol
                                },
                              ticks: {
                                  fontColor: xValCol
                              },
                              barPercentage: 0.4,
                              stacked: true,
                              beginAtZero: true
                            }],
                          yAxes: [{
                              gridLines: {
                                    color: yGCol
                                },
                              ticks: {
                                  fontColor: yValCol
                              },
                              stacked: true,
                              beginAtZero: true
                            }],
                        },
                    },
                   }
                );
            </script>
    </body>
{% endblock %}
